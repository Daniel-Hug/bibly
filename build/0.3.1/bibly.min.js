var bibly=window.bibly?window.bibly:{};bibly.version="0.3.1";bibly.max_nodes=500;bibly.className="bibly_reference";
(function(){function g(){h(document.body,1,j)}function h(b,c,a){for(var e=0;b&&c>0;){e++;if(e>=bibly.max_nodes){setTimeout(function(){h(b,c,a)},50);break}switch(b.nodeType){case 1:if(!k.test(b.tagName)&&b.childNodes.length>0){b=b.childNodes[0];c++;continue}break;case 3:case 4:b=a(b)}if(b.nextSibling)b=b.nextSibling;else for(;c>0;){b=b.parentNode;c--;if(b.nextSibling){b=b.nextSibling;break}}}}var l="\\b("+bible.genNames()+").?\\s+((\\d+)(:(\\d+))?(\\s?[-\u2013&]\\s?(\\d+))?((\\s?,\\s?(\\d+)(:(\\d+))?(\\s?[-\u2013&]\\s?(\\d+))?)|(\\s?;\\s?(\\d+):(\\d+)(\\s?[-\u2013&]\\s?(\\d+))?))*)\\b",
m=RegExp(l,"m"),n=RegExp("(\\d+)(:(\\d+))?(\\s?[-\u2013&]\\s?(\\d+))?","m"),k=/^(a|script|style|textarea)$/i,d=null,j=function(b){var c=m.exec(b.data),a;if(c){a=c[0];c=b.splitText(c.index);c.splitText(a.length);return b=i(b,c)}else return b},i=function(b,c){var a;a=c.textContent.indexOf(",");var e=c.textContent.indexOf(";");a=a>0&&e>0?Math.min(a,e):Math.max(a,e);var f;if(a>0){f=c.splitText(a);for(a=1;a<f.textContent.length&&f.textContent.substring(a,a+1)==" ";)a++;f=f.splitText(a)}a=b.ownerDocument.createElement("A");
b.parentNode.replaceChild(a,c);refText=c.textContent;e=o(refText);a.setAttribute("href",e.toShortUrl());a.setAttribute("title","Read "+e.toString());a.setAttribute("class",bibly.className);a.appendChild(c);if(f)a=i(b,f);return a},o=function(b){var c=new bible.Reference(b),a=null;if(c!=null&&typeof c.isValid!="undefined"&&c.isValid())return d=c;else{if(a=n.exec(b)){if(typeof a[1]!="undefined"&&typeof a[3]=="undefined"&&typeof a[5]=="undefined"){d.verse1=parseInt(a[1],10);d.chapter2=-1;d.verse2=-1}else if(typeof a[1]!=
"undefined"&&typeof a[3]!="undefined"&&typeof a[5]=="undefined"){d.chapter1=parseInt(a[1],10);d.verse1=parseInt(a[3],10);d.chapter2=-1;d.verse2=-1}else if(typeof a[1]!="undefined"&&typeof a[3]!="undefined"&&typeof a[5]!="undefined"){d.chapter1=parseInt(a[1],10);d.verse1=parseInt(a[3],10);d.chapter2=-1;d.verse2=parseInt(a[5],10)}else if(typeof a[1]!="undefined"&&typeof a[3]=="undefined"&&typeof a[5]!="undefined"){d.verse1=parseInt(a[1],10);d.chapter2=-1;d.verse2=parseInt(a[5],10)}return d}return{refText:b,
toShortUrl:function(){return"http://bib.ly/"+b.replace(/\s/ig,"").replace(/:/ig,".").replace(/\u2013/ig,"-")},toString:function(){return b+" = Can't parse it"}}}};if(window.attachEvent)window.attachEvent("onload",g);else if(window.addEventListener)window.addEventListener("load",g,false);else{__onload=window.onload;window.onload=function(){g();__onload()}}})();
